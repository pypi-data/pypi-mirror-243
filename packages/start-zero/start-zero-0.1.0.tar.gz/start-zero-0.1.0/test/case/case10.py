import numpy as np

from sz import Tensor
from sz import sin


x = Tensor(np.array([[1.0, 2, 11, 4, .8], [11, 12, 13, 14, 15], [.1, 2.3, .4, 5.6, .7]]))
y = sin(x)
y.backward()
for i in range(3):
    gx = x.grad
    x.clear_tensor()
    gx.backward()
    print(x.grad.data)
"""
[[-0.84147098 -0.90929743  0.99999021  0.7568025  -0.71735609]
 [ 0.99999021  0.53657292 -0.42016704 -0.99060736 -0.65028784]
 [-0.09983342 -0.74570521 -0.38941834  0.63126664 -0.64421769]]
[[-0.54030231  0.41614684 -0.0044257   0.65364362 -0.69670671]
 [-0.0044257  -0.84385396 -0.90744678 -0.13673722  0.75968791]
 [-0.99500417  0.66627602 -0.92106099 -0.77556588 -0.76484219]]
[[ 0.84147098  0.90929743 -0.99999021 -0.7568025   0.71735609]
 [-0.99999021 -0.53657292  0.42016704  0.99060736  0.65028784]
 [ 0.09983342  0.74570521  0.38941834 -0.63126664  0.64421769]]
"""
