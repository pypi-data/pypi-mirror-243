import{d as W,_ as Y,S as Z,g as f,M as b,f as r,$,a0 as j,a1 as G,a2 as K,a3 as Q,q as m,i as p,c as a,k as c,o as s,n,u as e,a4 as X,m as C,N as ee,F as V,a5 as se,a6 as oe,a as d,P as w,a7 as te,a8 as le,a9 as ae,aa as ne,ab as ue,ac as re,ad as ce,ae as de,H as ie,x as fe,af as me}from"./index-fTdQdbWK.js";import{u as pe}from"./usePageTitle-DKdFvDVI.js";const we={class:"flow-runs__list"},_e={class:"flow-runs__list-controls--right"},F=3e4,ye=W({__name:"FlowRuns",setup(Re){const N=Y(),_=Z(),R=f(),k=b(_.flowRuns.getFlowRunsCount,[{}]),S=r(()=>k.executed),h=r(()=>k.response===0),i=f(),x=$(i,1200),{filter:o,isCustomFilter:B}=j({flowRuns:{nameLike:x}}),v=r({get(){return o.flowRuns.parentTaskRunIdNull},set(g){o.flowRuns.parentTaskRunIdNull=g?!0:void 0}}),T=b(_.ui.getFlowRunHistory,[o],{interval:F}),H=r(()=>T.response??[]),{flowRuns:y,total:U,subscriptions:M,next:I}=G(o,{mode:"infinite",interval:F}),u=f([]),{margin:L}=K(),A=()=>({rootMargin:L.value}),{stuck:D}=Q(R,A),E=r(()=>({listControls:{"flow-runs__list-controls--stuck":D.value&&m.md}}));function O(){N.push(me.flowRuns())}const P=()=>{u.value=[],M.refresh()};return pe("Flow Runs"),(g,t)=>{const q=p("p-toggle"),z=p("p-button"),J=p("p-layout-default");return s(),a(J,{class:"flow-runs"},{header:c(()=>[n(e(X))]),default:c(()=>[S.value?(s(),C(V,{key:0},[h.value?(s(),a(e(ee),{key:0})):(s(),C(V,{key:1},[n(e(se)),e(m).md?(s(),a(e(oe),{key:0,history:H.value,"start-date":e(o).flowRuns.expectedStartTimeAfter,"end-date":e(o).flowRuns.expectedStartTimeBefore,class:"flow-runs__chart"},null,8,["history","start-date","end-date"])):d("",!0),w("div",we,[w("div",{ref_key:"listControls",ref:R,class:te(["flow-runs__list-controls",E.value.listControls])},[w("div",_e,[u.value.length==0?(s(),a(e(le),{key:0,count:e(U),label:"Flow run"},null,8,["count"])):(s(),a(e(ae),{key:1,count:u.value.length},null,8,["count"])),n(e(ne),{selected:u.value,onDelete:P},null,8,["selected"])]),n(q,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=l=>v.value=l),class:"flow-runs__subflows-toggle",append:"Hide subflows"},null,8,["modelValue"]),e(m).md?(s(),a(e(ue),{key:0,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=l=>i.value=l),placeholder:"Search by run name",label:"Search by run name"},null,8,["modelValue"])):d("",!0),n(e(re),{modelValue:e(o).sort,"onUpdate:modelValue":t[2]||(t[2]=l=>e(o).sort=l),class:"flow-runs__sort"},null,8,["modelValue"])],2),n(e(ce),{selected:u.value,"onUpdate:selected":t[3]||(t[3]=l=>u.value=l),selectable:"","flow-runs":e(y),onBottom:e(I)},null,8,["selected","flow-runs","onBottom"]),e(y).length?d("",!0):(s(),a(e(de),{key:0},ie({_:2},[e(B)?{name:"actions",fn:c(()=>[n(z,{small:"",onClick:O},{default:c(()=>[fe(" Clear Filters ")]),_:1})]),key:"0"}:void 0]),1024))])],64))],64)):d("",!0)]),_:1})}}});export{ye as default};
