{"version":3,"file":"a081f4d42ad4fcc6f181.chunk.js","mappings":"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","sources":["webpack://superset/./src/features/tags/TagModal.tsx","webpack://superset/./src/pages/Tags/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { ChangeEvent, useState, useEffect } from 'react';\nimport rison from 'rison';\nimport Modal from 'src/components/Modal';\nimport AsyncSelect from 'src/components/Select/AsyncSelect';\nimport { FormLabel } from 'src/components/Form';\nimport { t, styled, SupersetClient } from '@superset-ui/core';\nimport { Input } from 'antd';\nimport { Divider } from 'src/components';\nimport Button from 'src/components/Button';\nimport { Tag } from 'src/views/CRUD/types';\nimport { fetchObjects } from 'src/features/tags/tags';\n\nconst StyledModalBody = styled.div`\n  .ant-select-dropdown {\n    max-height: ${({ theme }) => theme.gridUnit * 40}px;\n  }\n  .tag-input {\n    margin-bottom: ${({ theme }) => theme.gridUnit * 3}px;\n  }\n`;\n\nexport interface TaggableResourceOption {\n  label: string;\n  value: number;\n  key: number;\n}\n\nexport enum TaggableResources {\n  Chart = 'chart',\n  Dashboard = 'dashboard',\n  SavedQuery = 'query',\n}\n\ninterface TagModalProps {\n  onHide: () => void;\n  refreshData: () => void;\n  addSuccessToast: (msg: string) => void;\n  addDangerToast: (msg: string) => void;\n  show: boolean;\n  clearOnHide?: boolean;\n  editTag?: Tag | null;\n}\n\nconst TagModal: React.FC<TagModalProps> = ({\n  show,\n  onHide,\n  editTag,\n  refreshData,\n  addSuccessToast,\n  addDangerToast,\n  clearOnHide = false,\n}) => {\n  const [dashboardsToTag, setDashboardsToTag] = useState<\n    TaggableResourceOption[]\n  >([]);\n  const [chartsToTag, setChartsToTag] = useState<TaggableResourceOption[]>([]);\n  const [savedQueriesToTag, setSavedQueriesToTag] = useState<\n    TaggableResourceOption[]\n  >([]);\n\n  const [tagName, setTagName] = useState<string>('');\n  const [description, setDescription] = useState<string>('');\n\n  const isEditMode = !!editTag;\n  const modalTitle = isEditMode ? 'Edit Tag' : 'Create Tag';\n\n  const clearResources = () => {\n    setDashboardsToTag([]);\n    setChartsToTag([]);\n    setSavedQueriesToTag([]);\n  };\n\n  const clearTagForm = () => {\n    setTagName('');\n    setDescription('');\n    setDashboardsToTag([]);\n    setChartsToTag([]);\n    setSavedQueriesToTag([]);\n  };\n\n  useEffect(() => {\n    const resourceMap: { [key: string]: TaggableResourceOption[] } = {\n      [TaggableResources.Dashboard]: [],\n      [TaggableResources.Chart]: [],\n      [TaggableResources.SavedQuery]: [],\n    };\n\n    const updateResourceOptions = ({ id, name, type }: Tag) => {\n      const resourceOptions = resourceMap[type];\n      if (resourceOptions) {\n        resourceOptions.push({\n          value: id,\n          label: name,\n          key: id,\n        });\n      }\n    };\n    clearResources();\n    if (isEditMode) {\n      fetchObjects(\n        { tags: editTag.name, types: null },\n        (data: Tag[]) => {\n          data.forEach(updateResourceOptions);\n          setDashboardsToTag(resourceMap[TaggableResources.Dashboard]);\n          setChartsToTag(resourceMap[TaggableResources.Chart]);\n          setSavedQueriesToTag(resourceMap[TaggableResources.SavedQuery]);\n        },\n        (error: Response) => {\n          addDangerToast('Error Fetching Tagged Objects');\n        },\n      );\n      setTagName(editTag.name);\n      setDescription(editTag.description);\n    }\n  }, [editTag]);\n\n  const loadData = async (\n    search: string,\n    page: number,\n    pageSize: number,\n    columns: string[],\n    filterColumn: string,\n    orderColumn: string,\n    endpoint: string,\n  ) => {\n    const queryParams = rison.encode({\n      columns,\n      filters: [\n        {\n          col: filterColumn,\n          opr: 'ct',\n          value: search,\n        },\n      ],\n      page,\n      order_column: orderColumn,\n    });\n\n    const { json } = await SupersetClient.get({\n      endpoint: `/api/v1/${endpoint}/?q=${queryParams}`,\n    });\n    const { result, count } = json;\n\n    return {\n      data: result.map((item: { id: number }) => ({\n        value: item.id,\n        label: item[filterColumn],\n      })),\n      totalCount: count,\n    };\n  };\n\n  const loadCharts = async (search: string, page: number, pageSize: number) =>\n    loadData(\n      search,\n      page,\n      pageSize,\n      ['id', 'slice_name'],\n      'slice_name',\n      'slice_name',\n      'chart',\n    );\n\n  const loadDashboards = async (\n    search: string,\n    page: number,\n    pageSize: number,\n  ) =>\n    loadData(\n      search,\n      page,\n      pageSize,\n      ['id', 'dashboard_title'],\n      'dashboard_title',\n      'dashboard_title',\n      'dashboard',\n    );\n\n  const loadQueries = async (search: string, page: number, pageSize: number) =>\n    loadData(\n      search,\n      page,\n      pageSize,\n      ['id', 'label'],\n      'label',\n      'label',\n      'saved_query',\n    );\n\n  const handleOptionChange = (resource: TaggableResources, data: any) => {\n    if (resource === TaggableResources.Dashboard) setDashboardsToTag(data);\n    else if (resource === TaggableResources.Chart) setChartsToTag(data);\n    else if (resource === TaggableResources.SavedQuery)\n      setSavedQueriesToTag(data);\n  };\n\n  const handleTagNameChange = (ev: ChangeEvent<HTMLInputElement>) =>\n    setTagName(ev.target.value);\n  const handleDescriptionChange = (ev: ChangeEvent<HTMLInputElement>) =>\n    setDescription(ev.target.value);\n\n  const onSave = () => {\n    const dashboards = dashboardsToTag.map(dash => ['dashboard', dash.value]);\n    const charts = chartsToTag.map(chart => ['chart', chart.value]);\n    const savedQueries = savedQueriesToTag.map(q => ['query', q.value]);\n\n    if (isEditMode) {\n      SupersetClient.put({\n        endpoint: `/api/v1/tag/${editTag.id}`,\n        jsonPayload: {\n          description,\n          name: tagName,\n          objects_to_tag: [...dashboards, ...charts, ...savedQueries],\n        },\n      })\n        .then(({ json = {} }) => {\n          refreshData();\n          clearTagForm();\n          addSuccessToast(t('Tag updated'));\n          onHide();\n        })\n        .catch(err => {\n          addDangerToast(err.message || 'Error Updating Tag');\n        });\n    } else {\n      SupersetClient.post({\n        endpoint: `/api/v1/tag/`,\n        jsonPayload: {\n          description,\n          name: tagName,\n          objects_to_tag: [...dashboards, ...charts, ...savedQueries],\n        },\n      })\n        .then(({ json = {} }) => {\n          refreshData();\n          clearTagForm();\n          addSuccessToast(t('Tag created'));\n          onHide();\n        })\n        .catch(err => addDangerToast(err.message || 'Error Creating Tag'));\n    }\n  };\n\n  return (\n    <Modal\n      title={modalTitle}\n      onHide={() => {\n        if (clearOnHide) clearTagForm();\n        onHide();\n      }}\n      show={show}\n      footer={\n        <div>\n          <Button\n            data-test=\"modal-save-dashboard-button\"\n            buttonStyle=\"secondary\"\n            onClick={onHide}\n          >\n            {t('Cancel')}\n          </Button>\n          <Button\n            data-test=\"modal-save-dashboard-button\"\n            buttonStyle=\"primary\"\n            onClick={onSave}\n          >\n            {t('Save')}\n          </Button>\n        </div>\n      }\n    >\n      <StyledModalBody>\n        <FormLabel>{t('Tag name')}</FormLabel>\n        <Input\n          className=\"tag-input\"\n          onChange={handleTagNameChange}\n          placeholder={t('Name of your tag')}\n          value={tagName}\n        />\n        <FormLabel>{t('Description')}</FormLabel>\n        <Input\n          className=\"tag-input\"\n          onChange={handleDescriptionChange}\n          placeholder={t('Add description of your tag')}\n          value={description}\n        />\n        <Divider />\n        <AsyncSelect\n          className=\"tag-input\"\n          ariaLabel={t('Select dashboards')}\n          mode=\"multiple\"\n          name=\"dashboards\"\n          // @ts-ignore\n          value={dashboardsToTag}\n          options={loadDashboards}\n          onChange={value =>\n            handleOptionChange(TaggableResources.Dashboard, value)\n          }\n          header={<FormLabel>{t('Dashboards')}</FormLabel>}\n          allowClear\n        />\n        <AsyncSelect\n          className=\"tag-input\"\n          ariaLabel={t('Select charts')}\n          mode=\"multiple\"\n          name=\"charts\"\n          // @ts-ignore\n          value={chartsToTag}\n          options={loadCharts}\n          onChange={value => handleOptionChange(TaggableResources.Chart, value)}\n          header={<FormLabel>{t('Charts')}</FormLabel>}\n          allowClear\n        />\n        <AsyncSelect\n          className=\"tag-input\"\n          ariaLabel={t('Select saved queries')}\n          mode=\"multiple\"\n          name=\"savedQueries\"\n          // @ts-ignore\n          value={savedQueriesToTag}\n          options={loadQueries}\n          onChange={value =>\n            handleOptionChange(TaggableResources.SavedQuery, value)\n          }\n          header={<FormLabel>{t('Saved queries')}</FormLabel>}\n          allowClear\n        />\n      </StyledModalBody>\n    </Modal>\n  );\n};\n\nexport default TagModal;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo, useState } from 'react';\nimport { isFeatureEnabled, FeatureFlag, t } from '@superset-ui/core';\nimport {\n  createFetchRelated,\n  createErrorHandler,\n  Actions,\n} from 'src/views/CRUD/utils';\nimport { useListViewResource, useFavoriteStatus } from 'src/views/CRUD/hooks';\nimport ConfirmStatusChange from 'src/components/ConfirmStatusChange';\nimport SubMenu, { SubMenuProps } from 'src/features/home/SubMenu';\nimport ListView, {\n  ListViewProps,\n  Filters,\n  FilterOperator,\n} from 'src/components/ListView';\nimport { dangerouslyGetItemDoNotUse } from 'src/utils/localStorageHelpers';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport Icons from 'src/components/Icons';\nimport { Tooltip } from 'src/components/Tooltip';\nimport FacePile from 'src/components/FacePile';\nimport { Link } from 'react-router-dom';\nimport { deleteTags } from 'src/features/tags/tags';\nimport { Tag as AntdTag } from 'antd';\nimport { Tag } from 'src/views/CRUD/types';\nimport TagModal from 'src/features/tags/TagModal';\nimport FaveStar from 'src/components/FaveStar';\n\nconst PAGE_SIZE = 25;\n\ninterface TagListProps {\n  addDangerToast: (msg: string) => void;\n  addSuccessToast: (msg: string) => void;\n  user: {\n    userId: string | number;\n    firstName: string;\n    lastName: string;\n  };\n}\n\nfunction TagList(props: TagListProps) {\n  const {\n    addDangerToast,\n    addSuccessToast,\n    user: { userId },\n  } = props;\n\n  const {\n    state: {\n      loading,\n      resourceCount: tagCount,\n      resourceCollection: tags,\n      bulkSelectEnabled,\n    },\n    hasPerm,\n    fetchData,\n    toggleBulkSelect,\n    refreshData,\n  } = useListViewResource<Tag>('tag', t('tag'), addDangerToast);\n\n  const [showTagModal, setShowTagModal] = useState<boolean>(false);\n  const [tagToEdit, setTagToEdit] = useState<Tag | null>(null);\n  const tagIds = useMemo(() => tags.map(c => c.id), [tags]);\n  const [saveFavoriteStatus, favoriteStatus] = useFavoriteStatus(\n    'tag',\n    tagIds,\n    addDangerToast,\n  );\n\n  // TODO: Fix usage of localStorage keying on the user id\n  const userKey = dangerouslyGetItemDoNotUse(userId?.toString(), null);\n\n  const canDelete = hasPerm('can_write');\n  const canEdit = hasPerm('can_write');\n\n  const initialSort = [{ id: 'changed_on_delta_humanized', desc: true }];\n\n  function handleTagsDelete(tags: Tag[]) {\n    deleteTags(\n      tags,\n      (msg: string) => {\n        addSuccessToast(msg);\n        refreshData();\n      },\n      msg => {\n        addDangerToast(msg);\n        refreshData();\n      },\n    );\n  }\n\n  const handleTagEdit = (tag: Tag) => {\n    setShowTagModal(true);\n    setTagToEdit(tag);\n  };\n\n  const emptyState = {\n    title: t('No Tags created'),\n    image: 'dashboard.svg',\n    description:\n      'Create a new tag and assign it to existing entities like charts or dashboards',\n    buttonAction: () => setShowTagModal(true),\n    buttonText: (\n      <>\n        <i className=\"fa fa-plus\" data-test=\"add-rule-empty\" />{' '}\n        {'Create a new Tag'}{' '}\n      </>\n    ),\n  };\n\n  const columns = useMemo(\n    () => [\n      {\n        Cell: ({\n          row: {\n            original: { id },\n          },\n        }: any) =>\n          userId && (\n            <FaveStar\n              itemId={id}\n              saveFaveStar={saveFavoriteStatus}\n              isStarred={favoriteStatus[id]}\n            />\n          ),\n        Header: '',\n        id: 'id',\n        disableSortBy: true,\n        size: 'xs',\n        hidden: !userId,\n      },\n      {\n        Cell: ({\n          row: {\n            original: { id, name: tagName },\n          },\n        }: any) => (\n          <AntdTag>\n            <Link to={`/superset/all_entities/?id=${id}`}>{tagName}</Link>\n          </AntdTag>\n        ),\n        Header: t('Name'),\n        accessor: 'name',\n      },\n      {\n        Cell: ({\n          row: {\n            original: { changed_on_delta_humanized: changedOn },\n          },\n        }: any) => <span className=\"no-wrap\">{changedOn}</span>,\n        Header: t('Modified'),\n        accessor: 'changed_on_delta_humanized',\n        size: 'xl',\n      },\n      {\n        Cell: ({\n          row: {\n            original: { created_by: createdBy },\n          },\n        }: any) => (createdBy ? <FacePile users={[createdBy]} /> : ''),\n        Header: t('Created by'),\n        accessor: 'created_by',\n        disableSortBy: true,\n        size: 'xl',\n      },\n      {\n        Cell: ({ row: { original } }: any) => {\n          const handleEdit = () => handleTagEdit(original);\n          return (\n            <Actions className=\"actions\">\n              {canDelete && (\n                <ConfirmStatusChange\n                  title={t('Please confirm')}\n                  description={\n                    <>\n                      {t('Are you sure you want to delete')}{' '}\n                      <b>{original.dashboard_title}</b>?\n                    </>\n                  }\n                  onConfirm={() => handleTagsDelete([original])}\n                >\n                  {confirmDelete => (\n                    <Tooltip\n                      id=\"delete-action-tooltip\"\n                      title={t('Delete')}\n                      placement=\"bottom\"\n                    >\n                      <span\n                        role=\"button\"\n                        tabIndex={0}\n                        className=\"action-button\"\n                        onClick={confirmDelete}\n                      >\n                        <Icons.Trash data-test=\"dashboard-list-trash-icon\" />\n                      </span>\n                    </Tooltip>\n                  )}\n                </ConfirmStatusChange>\n              )}\n              {canEdit && (\n                <Tooltip\n                  id=\"edit-action-tooltip\"\n                  title={t('Edit')}\n                  placement=\"bottom\"\n                >\n                  <span\n                    role=\"button\"\n                    tabIndex={0}\n                    className=\"action-button\"\n                    onClick={handleEdit}\n                  >\n                    <Icons.EditAlt data-test=\"edit-alt\" />\n                  </span>\n                </Tooltip>\n              )}\n            </Actions>\n          );\n        },\n        Header: t('Actions'),\n        id: 'actions',\n        hidden: !canDelete,\n        disableSortBy: true,\n      },\n    ],\n    [userId, canDelete, refreshData, addSuccessToast, addDangerToast],\n  );\n\n  const filters: Filters = useMemo(() => {\n    const filters_list = [\n      {\n        Header: t('Created by'),\n        id: 'created_by',\n        input: 'select',\n        operator: FilterOperator.relationOneMany,\n        unfilteredLabel: t('All'),\n        fetchSelects: createFetchRelated(\n          'tag',\n          'created_by',\n          createErrorHandler(errMsg =>\n            addDangerToast(\n              t(\n                'An error occurred while fetching tag created by values: %s',\n                errMsg,\n              ),\n            ),\n          ),\n          props.user,\n        ),\n        paginate: true,\n      },\n      {\n        Header: t('Search'),\n        id: 'name',\n        input: 'search',\n        operator: FilterOperator.contains,\n      },\n    ] as Filters;\n    return filters_list;\n  }, [addDangerToast, props.user]);\n\n  const sortTypes = [\n    {\n      desc: false,\n      id: 'name',\n      label: t('Alphabetical'),\n      value: 'alphabetical',\n    },\n    {\n      desc: true,\n      id: 'changed_on_delta_humanized',\n      label: t('Recently modified'),\n      value: 'recently_modified',\n    },\n    {\n      desc: false,\n      id: 'changed_on_delta_humanized',\n      label: t('Least recently modified'),\n      value: 'least_recently_modified',\n    },\n  ];\n\n  const subMenuButtons: SubMenuProps['buttons'] = [];\n\n  if (canDelete) {\n    subMenuButtons.push({\n      name: t('Bulk select'),\n      buttonStyle: 'secondary',\n      'data-test': 'bulk-select',\n      onClick: toggleBulkSelect,\n    });\n  }\n\n  // render new 'New Tag' btn\n  subMenuButtons.push({\n    name: (\n      <>\n        <i className=\"fa fa-plus\" /> {t('Tag')}\n      </>\n    ),\n    buttonStyle: 'primary',\n    'data-test': 'bulk-select',\n    onClick: () => setShowTagModal(true),\n  });\n\n  const handleBulkDelete = (tagsToDelete: Tag[]) =>\n    handleTagsDelete(tagsToDelete);\n\n  return (\n    <>\n      <TagModal\n        show={showTagModal}\n        onHide={() => {\n          setShowTagModal(false);\n          setTagToEdit(null);\n        }}\n        editTag={tagToEdit}\n        refreshData={refreshData}\n        addSuccessToast={addSuccessToast}\n        addDangerToast={addDangerToast}\n        clearOnHide\n      />\n      <SubMenu name={t('Tags')} buttons={subMenuButtons} />\n      <ConfirmStatusChange\n        title={t('Please confirm')}\n        description={t('Are you sure you want to delete the selected tags?')}\n        onConfirm={handleBulkDelete}\n      >\n        {confirmDelete => {\n          const bulkActions: ListViewProps['bulkActions'] = [];\n          if (canDelete) {\n            bulkActions.push({\n              key: 'delete',\n              name: t('Delete'),\n              type: 'danger',\n              onSelect: confirmDelete,\n            });\n          }\n          return (\n            <>\n              <ListView<Tag>\n                bulkActions={bulkActions}\n                bulkSelectEnabled={bulkSelectEnabled}\n                cardSortSelectOptions={sortTypes}\n                className=\"tags-list-view\"\n                columns={columns}\n                count={tagCount}\n                data={tags.filter(tag => !tag.name.includes(':'))}\n                disableBulkSelect={toggleBulkSelect}\n                refreshData={refreshData}\n                emptyState={emptyState}\n                fetchData={fetchData}\n                filters={filters}\n                initialSort={initialSort}\n                loading={loading}\n                addDangerToast={addDangerToast}\n                addSuccessToast={addSuccessToast}\n                pageSize={PAGE_SIZE}\n                showThumbnails={\n                  userKey\n                    ? userKey.thumbnails\n                    : isFeatureEnabled(FeatureFlag.THUMBNAILS)\n                }\n                defaultViewMode={\n                  isFeatureEnabled(FeatureFlag.LISTVIEWS_DEFAULT_CARD_VIEW)\n                    ? 'card'\n                    : 'table'\n                }\n              />\n            </>\n          );\n        }}\n      </ConfirmStatusChange>\n    </>\n  );\n}\n\nexport default withToasts(TagList);\n"],"names":["StyledModalBody","styled","div","_ref","theme","gridUnit","_ref2","TaggableResources","_ref3","show","onHide","editTag","refreshData","addSuccessToast","addDangerToast","clearOnHide","dashboardsToTag","setDashboardsToTag","useState","chartsToTag","setChartsToTag","savedQueriesToTag","setSavedQueriesToTag","tagName","setTagName","description","setDescription","isEditMode","modalTitle","clearTagForm","useEffect","resourceMap","Dashboard","Chart","SavedQuery","updateResourceOptions","_ref4","id","name","type","resourceOptions","push","value","label","key","fetchObjects","tags","types","data","forEach","error","loadData","async","search","page","pageSize","columns","filterColumn","orderColumn","endpoint","queryParams","rison","filters","col","opr","order_column","json","SupersetClient","get","result","count","map","item","totalCount","handleOptionChange","resource","___EmotionJSX","Modal","title","footer","Button","buttonStyle","onClick","t","onSave","dashboards","dash","charts","chart","savedQueries","q","put","jsonPayload","objects_to_tag","then","_ref5","catch","err","message","post","_ref6","FormLabel","Input","className","onChange","ev","target","placeholder","Divider","AsyncSelect","ariaLabel","mode","options","header","allowClear","withToasts","props","user","userId","state","loading","resourceCount","tagCount","resourceCollection","bulkSelectEnabled","hasPerm","fetchData","toggleBulkSelect","useListViewResource","showTagModal","setShowTagModal","tagToEdit","setTagToEdit","tagIds","useMemo","c","saveFavoriteStatus","favoriteStatus","useFavoriteStatus","userKey","dangerouslyGetItemDoNotUse","toString","canDelete","canEdit","initialSort","desc","handleTagsDelete","deleteTags","msg","emptyState","image","buttonAction","buttonText","React","Cell","row","original","FaveStar","itemId","saveFaveStar","isStarred","Header","disableSortBy","size","hidden","AntdTag","Link","to","accessor","changed_on_delta_humanized","changedOn","created_by","createdBy","FacePile","users","Actions","ConfirmStatusChange","dashboard_title","onConfirm","confirmDelete","Tooltip","placement","role","tabIndex","Icons","Trash","handleEdit","handleTagEdit","tag","EditAlt","input","operator","FilterOperator","relationOneMany","unfilteredLabel","fetchSelects","createFetchRelated","createErrorHandler","errMsg","paginate","contains","sortTypes","subMenuButtons","TagModal","SubMenu","buttons","tagsToDelete","bulkActions","onSelect","ListView","cardSortSelectOptions","filter","includes","disableBulkSelect","showThumbnails","thumbnails","isFeatureEnabled","FeatureFlag","THUMBNAILS","defaultViewMode","LISTVIEWS_DEFAULT_CARD_VIEW"],"sourceRoot":""}