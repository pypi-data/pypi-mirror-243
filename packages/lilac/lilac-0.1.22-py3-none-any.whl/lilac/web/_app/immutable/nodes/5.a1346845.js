import{S as de,i as ce,s as me,k as N,a as L,l as y,m as C,c as A,h as d,n as F,b as $,a0 as T,g as v,v as G,d as E,f as J,O as X,y as U,z as W,A as z,B as M,q as R,e as Y,r as P,u as Q,a1 as x,ab as ee,w as be,U as ve,V as ke}from"../chunks/index.6d58eddb.js";import{b as we,P as $e}from"../chunks/Page.d3a77107.js";import{g as Se}from"../chunks/navigation.e7a70f5c.js";import{D as Ie,R as De}from"../chunks/DatasetSettingsFields.2f827052.js";import{aI as Te,aW as Ee,aT as Ve,q as Ne,a3 as ye,a6 as Ce,a7 as Re,aN as Pe,a9 as ae,ag as Fe,ai as qe,aj as Oe,ak as Be,B as Le,ac as Ae,z as He,d as Ue}from"../chunks/Commands.83bc508c.js";import{T as _e}from"../chunks/ToastNotification.d571977d.js";function le(l){let s,t;return s=new _e({props:{hideCloseButton:!0,kind:"warning",fullWidth:!0,lowContrast:!0,title:"Unknown task",caption:"This could be from a stale link, or a new server instance."}}),{c(){U(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},i(e){t||(v(s.$$.fragment,e),t=!0)},o(e){E(s.$$.fragment,e),t=!1},d(e){M(s,e)}}}function ie(l){let s,t,e,i,n,a,o,m,f,c,I,b,_,k,V,g=l[3].status==="error"&&ne(l),p=l[3].status!="error"&&re(l);const H=[ze,We],q=[];function h(r,u){return r[3].status=="completed"?0:r[3].status==="error"?1:-1}return~(b=h(l))&&(_=q[b]=H[b](l)),{c(){s=N("section"),t=N("div"),e=R('Step 1: Load dataset "'),i=R(l[0]),n=R("/"),a=R(l[1]),o=R('"'),m=L(),f=N("div"),g&&g.c(),c=L(),p&&p.c(),I=L(),_&&_.c(),k=Y(),this.h()},l(r){s=y(r,"SECTION",{class:!0});var u=C(s);t=y(u,"DIV",{class:!0});var w=C(t);e=P(w,'Step 1: Load dataset "'),i=P(w,l[0]),n=P(w,"/"),a=P(w,l[1]),o=P(w,'"'),w.forEach(d),m=A(u),f=y(u,"DIV",{class:!0});var S=C(f);g&&g.l(S),S.forEach(d),c=A(u),p&&p.l(u),u.forEach(d),I=A(r),_&&_.l(r),k=Y(),this.h()},h(){F(t,"class","text-2xl text-gray-700"),F(f,"class","text-base"),F(s,"class","flex flex-col gap-y-2")},m(r,u){$(r,s,u),T(s,t),T(t,e),T(t,i),T(t,n),T(t,a),T(t,o),T(s,m),T(s,f),g&&g.m(f,null),T(s,c),p&&p.m(s,null),$(r,I,u),~b&&q[b].m(r,u),$(r,k,u),V=!0},p(r,u){(!V||u&1)&&Q(i,r[0]),(!V||u&2)&&Q(a,r[1]),r[3].status==="error"?g?g.p(r,u):(g=ne(r),g.c(),g.m(f,null)):g&&(g.d(1),g=null),r[3].status!="error"?p?(p.p(r,u),u&8&&v(p,1)):(p=re(r),p.c(),v(p,1),p.m(s,null)):p&&(G(),E(p,1,1,()=>{p=null}),J());let w=b;b=h(r),b===w?~b&&q[b].p(r,u):(_&&(G(),E(q[w],1,1,()=>{q[w]=null}),J()),~b?(_=q[b],_?_.p(r,u):(_=q[b]=H[b](r),_.c()),v(_,1),_.m(k.parentNode,k)):_=null)},i(r){V||(v(p),v(_),V=!0)},o(r){E(p),E(_),V=!1},d(r){r&&d(s),g&&g.d(),p&&p.d(),r&&d(I),~b&&q[b].d(r),r&&d(k)}}}function ne(l){let s,t,e,i;return{c(){s=R("Error loading "),t=R(l[0]),e=R("/"),i=R(l[1])},l(n){s=P(n,"Error loading "),t=P(n,l[0]),e=P(n,"/"),i=P(n,l[1])},m(n,a){$(n,s,a),$(n,t,a),$(n,e,a),$(n,i,a)},p(n,a){a&1&&Q(t,n[0]),a&2&&Q(i,n[1])},d(n){n&&d(s),n&&d(t),n&&d(e),n&&d(i)}}}function re(l){var o,m;let s,t,e,i,n;t=new we({props:{labelText:l[3].message||"",helperText:l[3].status!="completed"?l[3].details||void 0:"",value:l[3].status==="completed"?1:l[6],max:1,status:l[16][l[3].status]}});let a=((m=(o=l[5])==null?void 0:o.data)==null?void 0:m.total_num_rows)!=null&&oe(l);return{c(){s=N("div"),U(t.$$.fragment),e=L(),i=N("div"),a&&a.c(),this.h()},l(f){s=y(f,"DIV",{class:!0});var c=C(s);W(t.$$.fragment,c),c.forEach(d),e=A(f),i=y(f,"DIV",{class:!0});var I=C(i);a&&a.l(I),I.forEach(d),this.h()},h(){F(s,"class","mt-2"),F(i,"class","text-sm text-gray-700")},m(f,c){$(f,s,c),z(t,s,null),$(f,e,c),$(f,i,c),a&&a.m(i,null),n=!0},p(f,c){var b,_;const I={};c&8&&(I.labelText=f[3].message||""),c&8&&(I.helperText=f[3].status!="completed"?f[3].details||void 0:""),c&72&&(I.value=f[3].status==="completed"?1:f[6]),c&8&&(I.status=f[16][f[3].status]),t.$set(I),((_=(b=f[5])==null?void 0:b.data)==null?void 0:_.total_num_rows)!=null?a?a.p(f,c):(a=oe(f),a.c(),a.m(i,null)):a&&(a.d(1),a=null)},i(f){n||(v(t.$$.fragment,f),n=!0)},o(f){E(t.$$.fragment,f),n=!1},d(f){f&&d(s),M(t),f&&d(e),f&&d(i),a&&a.d()}}}function oe(l){var i,n;let s=((n=(i=l[5])==null?void 0:i.data)==null?void 0:n.total_num_rows)+"",t,e;return{c(){t=R(s),e=R(" rows loaded")},l(a){t=P(a,s),e=P(a," rows loaded")},m(a,o){$(a,t,o),$(a,e,o)},p(a,o){var m,f;o&32&&s!==(s=((f=(m=a[5])==null?void 0:m.data)==null?void 0:f.total_num_rows)+"")&&Q(t,s)},d(a){a&&d(t),a&&d(e)}}}function We(l){let s,t;return s=new _e({props:{hideCloseButton:!0,kind:"error",fullWidth:!0,lowContrast:!0,title:"Error loading dataset",caption:l[3].error||void 0}}),{c(){U(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},p(e,i){const n={};i&8&&(n.caption=e[3].error||void 0),s.$set(n)},i(e){t||(v(s.$$.fragment,e),t=!0)},o(e){E(s.$$.fragment,e),t=!1},d(e){M(s,e)}}}function ze(l){let s,t,e,i,n,a,o,m,f,c,I,b,_,k,V,g,p;function H(r){l[23](r)}let q={namespace:l[0],datasetName:l[1]};l[2]!==void 0&&(q.settings=l[2]),c=new Ie({props:q}),be.push(()=>ve(c,"settings",H));let h=l[9]!=null&&fe(l);return g=new Le({props:{disabled:l[2]==null,size:"xl",icon:Ae,iconDescription:"Open dataset",$$slots:{default:[Me]},$$scope:{ctx:l}}}),g.$on("click",l[24]),{c(){s=N("div"),t=N("section"),e=N("div"),i=N("div"),n=R("Step 2: Choose settings"),a=L(),o=N("div"),m=R("These settings can be changed from the dataset page at any time."),f=L(),U(c.$$.fragment),b=L(),_=N("div"),h&&h.c(),k=L(),V=N("div"),U(g.$$.fragment),this.h()},l(r){s=y(r,"DIV",{class:!0});var u=C(s);t=y(u,"SECTION",{class:!0});var w=C(t);e=y(w,"DIV",{class:!0});var S=C(e);i=y(S,"DIV",{class:!0});var O=C(i);n=P(O,"Step 2: Choose settings"),O.forEach(d),a=A(S),o=y(S,"DIV",{class:!0});var j=C(o);m=P(j,"These settings can be changed from the dataset page at any time."),j.forEach(d),S.forEach(d),f=A(w),W(c.$$.fragment,w),w.forEach(d),u.forEach(d),b=A(r),_=y(r,"DIV",{});var B=C(_);h&&h.l(B),B.forEach(d),k=A(r),V=y(r,"DIV",{class:!0});var K=C(V);W(g.$$.fragment,K),K.forEach(d),this.h()},h(){F(i,"class","text-2xl text-gray-700"),F(o,"class","text-sm text-gray-500"),F(e,"class","flex flex-col gap-y-2"),F(t,"class","flex flex-col gap-y-4"),F(s,"class","my-8"),F(V,"class","dataset-link mt-8")},m(r,u){$(r,s,u),T(s,t),T(t,e),T(e,i),T(i,n),T(e,a),T(e,o),T(o,m),T(t,f),z(c,t,null),$(r,b,u),$(r,_,u),h&&h.m(_,null),$(r,k,u),$(r,V,u),z(g,V,null),p=!0},p(r,u){const w={};u&1&&(w.namespace=r[0]),u&2&&(w.datasetName=r[1]),!I&&u&4&&(I=!0,w.settings=r[2],ke(()=>I=!1)),c.$set(w),r[9]!=null?h?(h.p(r,u),u&512&&v(h,1)):(h=fe(r),h.c(),v(h,1),h.m(_,null)):h&&(G(),E(h,1,1,()=>{h=null}),J());const S={};u&4&&(S.disabled=r[2]==null),u&67108864&&(S.$$scope={dirty:u,ctx:r}),g.$set(S)},i(r){p||(v(c.$$.fragment,r),v(h),v(g.$$.fragment,r),p=!0)},o(r){E(c.$$.fragment,r),E(h),E(g.$$.fragment,r),p=!1},d(r){r&&d(s),M(c),r&&d(b),r&&d(_),h&&h.d(),r&&d(k),r&&d(V),M(g)}}}function fe(l){let s,t,e,i,n;return i=new De({props:{rowId:l[9],mediaFields:l[7],highlightedFields:l[8]}}),{c(){s=N("div"),t=R("Preview"),e=L(),U(i.$$.fragment),this.h()},l(a){s=y(a,"DIV",{class:!0});var o=C(s);t=P(o,"Preview"),o.forEach(d),e=A(a),W(i.$$.fragment,a),this.h()},h(){F(s,"class","text-xl text-gray-700")},m(a,o){$(a,s,o),T(s,t),$(a,e,o),z(i,a,o),n=!0},p(a,o){const m={};o&512&&(m.rowId=a[9]),o&128&&(m.mediaFields=a[7]),o&256&&(m.highlightedFields=a[8]),i.$set(m)},i(a){n||(v(i.$$.fragment,a),n=!0)},o(a){E(i.$$.fragment,a),n=!1},d(a){a&&d(s),a&&d(e),M(i,a)}}}function Me(l){let s;return{c(){s=R("Save and open dataset")},l(t){s=P(t,"Save and open dataset")},m(t,e){$(t,s,e)},d(t){t&&d(s)}}}function je(l){let s,t,e,i,n=l[4].isSuccess&&l[3]==null&&le(),a=l[3]&&ie(l);return{c(){s=N("div"),t=N("div"),n&&n.c(),e=L(),a&&a.c(),this.h()},l(o){s=y(o,"DIV",{class:!0});var m=C(s);t=y(m,"DIV",{class:!0});var f=C(t);n&&n.l(f),e=A(f),a&&a.l(f),f.forEach(d),m.forEach(d),this.h()},h(){F(t,"class","center-panel mx-auto p-8 svelte-af9918"),F(s,"class","w-full overflow-y-scroll")},m(o,m){$(o,s,m),T(s,t),n&&n.m(t,null),T(t,e),a&&a.m(t,null),i=!0},p(o,[m]){o[4].isSuccess&&o[3]==null?n?m&24&&v(n,1):(n=le(),n.c(),v(n,1),n.m(t,e)):n&&(G(),E(n,1,1,()=>{n=null}),J()),o[3]?a?(a.p(o,m),m&8&&v(a,1)):(a=ie(o),a.c(),v(a,1),a.m(t,null)):a&&(G(),E(a,1,1,()=>{a=null}),J())},i(o){i||(v(n),v(a),i=!0)},o(o){E(n),E(a),i=!1},d(o){o&&d(s),n&&n.d(),a&&a.d()}}}function Ge(l,s,t){let e,i,n,a,o,m,f,c,I,b,_,k,V=x,g=()=>(V(),V=ee(i,D=>t(20,k=D)),i),p,H=x,q=()=>(H(),H=ee(n,D=>t(21,p=D)),n),h,r,u=x,w=()=>(u(),u=ee(a,D=>t(5,r=D)),a);l.$$.on_destroy.push(()=>V()),l.$$.on_destroy.push(()=>H()),l.$$.on_destroy.push(()=>u());let{namespace:S}=s,{datasetName:O}=s,{loadingTaskId:j}=s,B;const K=Te();X(l,K,D=>t(25,b=D));const Z=Ee(S,O);X(l,Z,D=>t(22,h=D)),Ve(Z);const te=Ne();X(l,te,D=>t(4,_=D));const pe={pending:"active",completed:"finished",error:"error"};function se(){B!=null&&b.mutate([S,O,B],{onSuccess:()=>{Se(He(S,O))}})}function ge(D){B=D,t(2,B)}const he=()=>se();return l.$$set=D=>{"namespace"in D&&t(0,S=D.namespace),"datasetName"in D&&t(1,O=D.datasetName),"loadingTaskId"in D&&t(18,j=D.loadingTaskId)},l.$$.update=()=>{l.$$.dirty&262160&&t(3,c=j!=null&&_.data!=null?_.data.tasks[j]:null),l.$$.dirty&8&&t(19,e=(c==null?void 0:c.status)=="completed"),l.$$.dirty&524291&&g(t(12,i=e?ye(S,O):null)),l.$$.dirty&4718595&&q(t(11,n=e?Ce(S,O,Re(h)):null)),l.$$.dirty&1048579&&w(t(10,a=S&&O&&(k==null?void 0:k.data)!=null?Pe(S,O,{columns:[ae],limit:1,combine_columns:!0},k.data):null)),l.$$.dirty&32&&t(9,o=(r==null?void 0:r.data)!=null?qe.value(Oe(r.data.rows[0],[ae]),"string"):null),l.$$.dirty&6291456&&t(8,m=Fe(h.query,p==null?void 0:p.data)),l.$$.dirty&1048580&&t(7,f=B!=null&&(k==null?void 0:k.data)!=null?Be(k==null?void 0:k.data,B):[]),l.$$.dirty&8&&t(6,I=(c==null?void 0:c.step_progress)==null?void 0:c.step_progress)},[S,O,B,c,_,r,I,f,m,o,a,n,i,K,Z,te,pe,se,j,e,k,p,h,ge,he]}class Je extends de{constructor(s){super(),ce(this,s,Ge,je,me,{namespace:0,datasetName:1,loadingTaskId:18})}}function ue(l){let s,t;return s=new Je({props:{namespace:l[0],datasetName:l[1],loadingTaskId:l[2]}}),{c(){U(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},p(e,i){const n={};i&1&&(n.namespace=e[0]),i&2&&(n.datasetName=e[1]),i&4&&(n.loadingTaskId=e[2]),s.$set(n)},i(e){t||(v(s.$$.fragment,e),t=!0)},o(e){E(s.$$.fragment,e),t=!1},d(e){M(s,e)}}}function Ke(l){let s,t,e=l[0]!=null&&l[1]!=null&&l[2]!=null&&ue(l);return{c(){e&&e.c(),s=Y()},l(i){e&&e.l(i),s=Y()},m(i,n){e&&e.m(i,n),$(i,s,n),t=!0},p(i,n){i[0]!=null&&i[1]!=null&&i[2]!=null?e?(e.p(i,n),n&7&&v(e,1)):(e=ue(i),e.c(),v(e,1),e.m(s.parentNode,s)):e&&(G(),E(e,1,1,()=>{e=null}),J())},i(i){t||(v(e),t=!0)},o(i){E(e),t=!1},d(i){e&&e.d(i),i&&d(s)}}}function Qe(l){let s,t;return s=new $e({props:{$$slots:{default:[Ke]},$$scope:{ctx:l}}}),{c(){U(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},p(e,[i]){const n={};i&39&&(n.$$scope={dirty:i,ctx:e}),s.$set(n)},i(e){t||(v(s.$$.fragment,e),t=!0)},o(e){E(s.$$.fragment,e),t=!1},d(e){M(s,e)}}}function Xe(l,s,t){let e,i,n,a;const o=Ue();return X(l,o,m=>t(4,e=m)),l.$$.update=()=>{l.$$.dirty&16&&e.page==="datasets/loading"&&e.identifier!=null&&t(0,[i,n,a]=e.identifier.split("/"),i,(t(1,n),t(4,e)),(t(2,a),t(4,e)))},[i,n,a,o,e]}class at extends de{constructor(s){super(),ce(this,s,Xe,Qe,me,{})}}export{at as component};
