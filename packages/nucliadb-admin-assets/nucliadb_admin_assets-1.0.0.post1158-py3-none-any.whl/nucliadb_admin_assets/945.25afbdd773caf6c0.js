"use strict";(self.webpackChunknucliadb_admin=self.webpackChunknucliadb_admin||[]).push([[945],{7945:(de,O,o)=>{o.r(O),o.d(O,{WidgetsModule:()=>ge});var w=o(6814),g=o(6223),y=o(4922),c=o(7844),C=o(9515),k=o(1848),e=o(9212),u=o(5068),p=o(7398),M=o(8645),N=o(9315),m=o(8180),U=o(2572),G=o(4664),I=o(9773),J=o(3620),j=o(9579),L=o(4188),F=o(6629),R=o(9954),b=o(2939);let E=(()=>{class a{constructor(t){this.modal=t}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(c.bj))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-widget-hint"]],decls:19,vars:12,consts:[[1,"hint"],["name","check"],["kind","secondary","aspect","basic",3,"click"]],template:function(i,n){1&i&&(e.TgZ(0,"pa-modal-dialog")(1,"pa-modal-title"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"pa-modal-content")(5,"div",0),e._UZ(6,"pa-icon",1),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e.TgZ(10,"div",0),e._UZ(11,"pa-icon",1),e.TgZ(12,"div"),e._uU(13),e.ALo(14,"translate"),e.qZA()()(),e.TgZ(15,"pa-modal-footer")(16,"pa-button",2),e.NdJ("click",function(){return n.modal.close()}),e._uU(17),e.ALo(18,"translate"),e.qZA()()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,4,"stash.widgets.recommendations")),e.xp6(6),e.Oqu(e.lcZ(9,6,"stash.widgets.hint_1")),e.xp6(5),e.Oqu(e.lcZ(14,8,"stash.widgets.hint_2")),e.xp6(4),e.hij(" ",e.lcZ(18,10,"generic.close")," "))},dependencies:[L.r,F.o,R.h,b.vP,b.If,b.jh,C.X$],styles:['@charset "UTF-8";.hint[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}']})}return a})();var W=o(229),$=o(3890),S=o(6593),q=o(8530),H=o(7467),Q=o(5758),Y=o(5207);function K(a,l){if(1&a&&(e.TgZ(0,"div",10),e._UZ(1,"span",11),e.ALo(2,"translate"),e.TgZ(3,"a",12),e.ALo(4,"async"),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,3,"stash.widgets.publish_kb"),e.oJD),e.xp6(2),e.Q6J("routerLink",e.lcZ(4,5,t.homeUrl)),e.xp6(2),e.Oqu(e.lcZ(6,7,"stash.widgets.publish_kb_link"))}}function D(a,l){if(1&a&&(e.TgZ(0,"div",5),e._UZ(1,"pa-icon",6),e.TgZ(2,"div",7),e._UZ(3,"div",8),e.ALo(4,"translate"),e.YNc(5,K,7,9,"div",9),e.ALo(6,"async"),e.qZA()()),2&a){const t=e.oxw();e.xp6(3),e.Q6J("innerHTML",e.lcZ(4,2,"stash.widgets.warning"),e.oJD),e.xp6(2),e.Q6J("ngIf",e.lcZ(6,4,t.showLink))}}function z(a,l){1&a&&(e.TgZ(0,"pa-textarea",45),e.ALo(1,"translate"),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&a&&(e.Q6J("help",e.lcZ(1,3,"stash.widgets.prompt.help"))("rows",2),e.xp6(2),e.hij(" ",e.lcZ(3,5,"stash.widgets.prompt.label")," "))}function V(a,l){1&a&&(e.TgZ(0,"pa-toggle",46),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"stash.widgets.autocompleteFromNERs.label")," "))}function B(a,l){1&a&&(e.TgZ(0,"pa-toggle",47),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"stash.widgets.suggestLabels.label")," "))}function X(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"pa-checkbox",49),e.NdJ("valueChange",function(n){e.CHM(t);const s=e.oxw(3);return e.KtG(s.filters.entities=n)})("valueChange",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.onFiltersChange())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("value",t.filters.entities)("disabled",t.filters.entities&&t.hasOneFilter),e.xp6(1),e.hij(" ",e.lcZ(2,3,"stash.widgets.entities")," ")}}function ee(a,l){1&a&&(e._UZ(0,"div",52),e.ALo(1,"translate")),2&a&&e.Q6J("innerHtml",e.lcZ(1,1,"stash.widgets.created-warning"),e.oJD)}function te(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",48)(1,"pa-checkbox",49),e.NdJ("valueChange",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.filters.labels=n)})("valueChange",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onFiltersChange())}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"pa-checkbox",49),e.NdJ("valueChange",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.filters.labelFamilies=n)})("valueChange",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onFiltersChange())}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,X,3,5,"pa-checkbox",50),e.ALo(8,"async"),e.TgZ(9,"div")(10,"pa-checkbox",49),e.NdJ("valueChange",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.filters.created=n)})("valueChange",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onFiltersChange())}),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.YNc(13,ee,2,3,"div",51),e.qZA()()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("value",t.filters.labels)("disabled",t.filters.labels&&t.hasOneFilter),e.xp6(1),e.hij(" ",e.lcZ(3,11,"stash.widgets.labels")," "),e.xp6(2),e.Q6J("value",t.filters.labelFamilies)("disabled",t.filters.labelFamilies&&t.hasOneFilter),e.xp6(1),e.hij(" ",e.lcZ(6,13,"stash.widgets.labelFamilies")," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(8,15,t.isEntityFiltersEnabled)),e.xp6(3),e.Q6J("value",t.filters.created)("disabled",t.filters.created&&t.hasOneFilter),e.xp6(1),e.hij(" ",e.lcZ(12,17,"stash.widgets.created")," "),e.xp6(2),e.Q6J("ngIf",t.filters.created)}}function ne(a,l){1&a&&(e.TgZ(0,"pa-toggle",53),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"stash.widgets.knowledgeGraph.label")," "))}function ae(a,l){1&a&&(e.TgZ(0,"pa-toggle",54),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"stash.widgets.synonyms.label")," "))}function ie(a,l){1&a&&(e.TgZ(0,"pa-toggle",55),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"stash.widgets.hideLogo.label")," "))}function oe(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"pa-button",56),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.copy())}),e._uU(1," Copy snippet "),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("icon",t.copyIcon)}}function se(a,l){1&a&&(e.TgZ(0,"div",5),e._UZ(1,"pa-icon",57),e.TgZ(2,"div",7)(3,"div",58),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",59),e._uU(7),e.ALo(8,"translate"),e.qZA()()()),2&a&&(e.xp6(4),e.hij(" ",e.lcZ(5,2,"stash.widgets.warning-dangerous-snippet")," "),e.xp6(3),e.Oqu(e.lcZ(8,4,"stash.widgets.warning-dangerous-snippet-details")))}function re(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"form",13)(1,"div",14)(2,"section",15)(3,"h3"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"pa-input",16),e.NdJ("valueChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.placeholder=n)})("valueChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.onPlaceholderChange(n))}),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.YNc(9,z,4,7,"pa-textarea",17),e.ALo(10,"async"),e.TgZ(11,"pa-textarea",18),e.ALo(12,"translate"),e.ALo(13,"translate"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"div",19)(17,"pa-toggle",20),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.YNc(20,V,3,3,"pa-toggle",21),e.ALo(21,"async"),e.YNc(22,B,3,3,"pa-toggle",22),e.ALo(23,"async"),e.TgZ(24,"pa-toggle",23),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.YNc(27,te,14,19,"div",24),e.TgZ(28,"pa-toggle",25),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"pa-toggle",26),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"pa-toggle",27),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"pa-toggle",28),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.YNc(40,ne,3,3,"pa-toggle",29),e.ALo(41,"async"),e.TgZ(42,"pa-toggle",30),e.NdJ("valueChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.updateTarget(n))}),e._uU(43),e.ALo(44,"translate"),e.qZA(),e.TgZ(45,"pa-toggle",31),e._uU(46),e.ALo(47,"translate"),e.qZA(),e.TgZ(48,"pa-toggle",32),e._uU(49),e.ALo(50,"translate"),e.qZA(),e.TgZ(51,"pa-toggle",33),e._uU(52),e.ALo(53,"translate"),e.qZA(),e.YNc(54,ae,3,3,"pa-toggle",34),e.ALo(55,"async"),e.TgZ(56,"pa-toggle",35),e._uU(57),e.ALo(58,"translate"),e.qZA(),e.TgZ(59,"pa-toggle",36),e._uU(60),e.ALo(61,"translate"),e.qZA(),e.TgZ(62,"pa-toggle",37),e._uU(63),e.ALo(64,"translate"),e.qZA(),e.TgZ(65,"pa-toggle",38),e._uU(66),e.ALo(67,"translate"),e.qZA(),e.YNc(68,ie,3,3,"pa-toggle",39),e.ALo(69,"async"),e.qZA(),e.TgZ(70,"pa-toggle",40),e._uU(71),e.ALo(72,"translate"),e.qZA()(),e.TgZ(73,"section",41)(74,"h3"),e._uU(75),e.ALo(76,"translate"),e.TgZ(77,"pa-button",42),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.showHints())}),e._uU(78),e.ALo(79,"translate"),e.qZA(),e.YNc(80,oe,2,1,"pa-button",43),e.qZA(),e.YNc(81,se,9,6,"div",1),e.ALo(82,"async"),e.TgZ(83,"pre")(84,"code",44),e._uU(85),e.qZA()()()()()}if(2&a){const t=e.oxw();e.Q6J("formGroup",t.mainForm),e.xp6(4),e.Oqu(e.lcZ(5,35,"stash.widgets.configuration")),e.xp6(2),e.Q6J("value",t.placeholder),e.xp6(1),e.hij(" ",e.lcZ(8,37,"stash.widgets.placeholder")," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(10,39,t.isUserPromptsEnabled)),e.xp6(2),e.Q6J("rows",2)("placeholder",e.lcZ(12,41,"stash.widgets.preselected-filters.placeholder"))("help",e.lcZ(13,43,"stash.widgets.preselected-filters.help")),e.xp6(3),e.hij(" ",e.lcZ(15,45,"stash.widgets.preselected-filters.label")," "),e.xp6(4),e.hij(" ",e.lcZ(19,47,"stash.widgets.suggestions.label")," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(21,49,t.canSuggestEntities)),e.xp6(2),e.Q6J("ngIf",e.lcZ(23,51,t.isTrainingEnabled)),e.xp6(3),e.hij(" ",e.lcZ(26,53,"stash.widgets.filter.label")," "),e.xp6(2),e.Q6J("ngIf",t.mainFormFeatures.filter),e.xp6(2),e.hij(" ",e.lcZ(30,55,"stash.widgets.answers.label")," "),e.xp6(3),e.hij(" ",e.lcZ(33,57,"stash.widgets.onlyAnswers.label")," "),e.xp6(3),e.hij(" ",e.lcZ(36,59,"stash.widgets.hideSources.label")," "),e.xp6(3),e.hij(" ",e.lcZ(39,61,"stash.widgets.relations.label")," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(41,63,t.isKnowledgeGraphEnabled)),e.xp6(3),e.hij(" ",e.lcZ(44,65,"stash.widgets.navigateToLink.label")," "),e.xp6(3),e.hij(" ",e.lcZ(47,67,"stash.widgets.targetNewTab.label")," "),e.xp6(3),e.hij(" ",e.lcZ(50,69,"stash.widgets.navigateToFile.label")," "),e.xp6(3),e.hij(" ",e.lcZ(53,71,"stash.widgets.permalink.label")," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(55,73,t.areSynonymsEnabled)),e.xp6(3),e.hij(" ",e.lcZ(58,75,"stash.widgets.autofilter.label")," "),e.xp6(3),e.hij(" ",e.lcZ(61,77,"stash.widgets.displayMetadata.label")," "),e.xp6(3),e.hij(" ",e.lcZ(64,79,"stash.widgets.hideThumbnails.label")," "),e.xp6(3),e.hij(" ",e.lcZ(67,81,"stash.widgets.noBM25forChat.label")," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(69,83,t.canHideLogo)),e.xp6(3),e.hij(" ",e.lcZ(72,85,"stash.widgets.darkMode.label")," "),e.xp6(4),e.hij(" ",e.lcZ(76,87,"stash.widgets.snippet")," "),e.xp6(3),e.hij(" ",e.lcZ(79,89,"stash.widgets.recommendations")," "),e.xp6(2),e.Q6J("ngIf",t.clipboardSupported),e.xp6(1),e.Q6J("ngIf",e.lcZ(82,91,t.showWarning)),e.xp6(4),e.Oqu(t.snippet)}}const le={features:[]},x="NUCLIA_WIDGETS_CONFIGURATION",ce=[{path:"",component:(()=>{class a{get mainFormFeatures(){return this.mainForm?.controls.features.value||{}}get features(){return Object.entries(this.mainFormFeatures).reduce((t,[i,n])=>(n&&(t=`${t.length>0?t+",":""}${i}`),t),"")}get filtersValue(){return Object.entries(this.filters).filter(([,t])=>t).map(([t])=>t).join(",")}get hasOneFilter(){return 1===Object.entries(this.filters).filter(([,t])=>t).length}constructor(t,i,n,s,d,Z,f,v,A,T){this.fb=t,this.sanitized=i,this.cdr=n,this.backendConfig=s,this.tracking=d,this.translation=Z,this.modalService=f,this.sdk=v,this.navigation=A,this.featureFlag=T,this.localStorage=(0,e.f3M)(W.H3),this.showWarning=this.sdk.currentKb.pipe((0,p.U)(r=>"PRIVATE"===r.state)),this.showLink=this.sdk.currentKb.pipe((0,p.U)(r=>!!r.admin&&"PRIVATE"===r.state)),this.homeUrl=this.navigation.homeUrl,this.validationMessages={title:{sluggable:"stash.widgets.invalid-id"}},this.filters={labels:!0,entities:!0,created:!1,labelFamilies:!1},this.snippet="",this.snippetPreview="",this.unsubscribeAll=new M.x,this.clipboardSupported=!(!navigator.clipboard||!navigator.clipboard.writeText),this.copyIcon="copy",this.isTrainingEnabled=this.tracking.isFeatureEnabled("training"),this.canSuggestEntities=this.tracking.isFeatureEnabled("suggest-entities"),this.isEntityFiltersEnabled=this.tracking.isFeatureEnabled("entity-filter"),this.isKnowledgeGraphEnabled=this.tracking.isFeatureEnabled("knowledge-graph"),this.areSynonymsEnabled=this.sdk.currentAccount.pipe((0,p.U)(r=>r.type),(0,p.U)(r=>!!r&&["stash-growth","stash-startup","stash-enterprise"].includes(r))),this.canHideLogo=this.sdk.currentAccount.pipe((0,p.U)(r=>["stash-growth","stash-startup","stash-enterprise"].includes(r.type))),this.isUserPromptsEnabled=(0,N.D)([this.featureFlag.isFeatureEnabled("user-prompts").pipe((0,m.q)(1)),this.sdk.currentAccount.pipe((0,p.U)(r=>["stash-growth","stash-enterprise"].includes(r.type)),(0,m.q)(1))]).pipe((0,p.U)(([r,_])=>r||_)),this.debouncePlaceholder=new M.x;const h=this.localStorage.getItem(x);if(h)try{this.widgetConfigurations=JSON.parse(h)}catch{this.widgetConfigurations={},this.localStorage.setItem(x,"{}")}else this.widgetConfigurations={};this.preloadAlternativeWidget()}ngOnInit(){(0,U.a)([this.sdk.currentKb,this.isEntityFiltersEnabled]).pipe((0,G.w)(([t,i])=>{const n=this.widgetConfigurations[t.id]||le;return this.placeholder=n.placeholder,this.filters.entities=!!i,n.filters&&(this.filters=n.filters),this.mainForm=this.fb.group({darkMode:[n.features.includes("darkMode")],prompt:[],preselectedFilters:"",features:this.fb.group({autofilter:[n.features.includes("autofilter")],answers:[n.features.includes("answers")],filter:[n.features.includes("filter")],navigateToFile:[n.features.includes("navigateToFile")],navigateToLink:[n.features.includes("navigateToLink")],targetNewTab:[n.features.includes("targetNewTab")],onlyAnswers:[n.features.includes("onlyAnswers")],hideSources:[n.features.includes("hideSources")],hideThumbnails:[n.features.includes("hideThumbnails")],permalink:[n.features.includes("permalink")],relations:[n.features.includes("relations")],suggestLabels:[n.features.includes("suggestLabels")],autocompleteFromNERs:[n.features.includes("autocompleteFromNERs")],suggestions:[n.features.includes("suggestions")],useSynonyms:[n.features.includes("useSynonyms")],displayMetadata:[n.features.includes("displayMetadata")],noBM25forChat:[n.features.includes("noBM25forChat")],hideLogo:[n.features.includes("hideLogo")],knowledgeGraph:[n.features.includes("knowledgeGraph")]})}),setTimeout(()=>this.generateSnippet(),100),this.mainForm.valueChanges}),(0,I.R)(this.unsubscribeAll)).subscribe(()=>{this.onFormChange(),this.mainForm?.markAsDirty()}),this.debouncePlaceholder.pipe((0,J.b)(500)).subscribe(t=>{this.placeholder=t||void 0,this.onFormChange()})}ngOnDestroy(){this.unsubscribeAll.next(),this.unsubscribeAll.complete(),this.deletePreview()}deletePreview(){const t=document.querySelector("nuclia-search"),i=document.querySelector("nuclia-search-bar"),n=document.querySelector("nuclia-search-results");"function"==typeof t?.$destroy&&t.$destroy(),"function"==typeof i?.$destroy&&i.$destroy(),"function"==typeof n?.$destroy&&n.$destroy(),t?.remove(),i?.remove(),n?.remove()}generateSnippet(){this.deletePreview();const t=this.hasPlaceholder()?`\n  placeholder="${this.placeholder}"`:"";let i="",n="";const s=this.mainForm?.controls.prompt.getRawValue();s&&(i=`prompt="${s}"`,n=`prompt="${s.replace(/"/g,'\\"').replace(/\n/g,"\\n")}"\n`),this.sdk.currentKb.pipe((0,m.q)(1)).subscribe(d=>{const Z=this.sdk.nuclia.options.standalone?'standalone="true"':`zone="${this.sdk.nuclia.options.zone}"`,f='apikey="YOUR_API_TOKEN"',v="PRIVATE"===d.state?`\n  state="${d.state}"\n  account="${d.account}"\n  kbslug="${d.slug}"\n  ${f}`:"",A=this.sdk.nuclia.options.standalone?`\n  backend="${this.backendConfig.getAPIURL()}"`:"",T=this.mainFormFeatures.filter?`\n  filters="${this.filtersValue}"`:"",h=(this.mainForm?.controls.preselectedFilters.getRawValue()||"").split("\n").map(pe=>pe.trim()).join(","),r=h?`\n  preselected_filters="${h}"\n      `:"",_=this.mainForm?.controls.darkMode.getRawValue()?'mode="dark"':"",P=`<nuclia-search-bar ${_}\n  knowledgebox="${d.id}"\n  ${Z}\n  features="${this.features}" ${t}${T}${r}${v}${A}></nuclia-search-bar>\n<nuclia-search-results ${_}></nuclia-search-results>`;this.snippet=`<script src="https://cdn.nuclia.cloud/nuclia-video-widget.umd.js"><\/script>\n${P.replace("zone=",n+"  zone=")}`,this.snippetPreview=this.sanitized.bypassSecurityTrustHtml(P.replace("zone=",`client="dashboard" backend="${this.backendConfig.getAPIURL()}"\n      lang="${this.translation.currentLang}"\n      ${i}\n      zone=`).replace("standalone=",'client="dashboard" standalone=').replace(f,""))}),(0,c.$)(this.cdr)}hasPlaceholder(){return!!this.placeholder}copy(){navigator.clipboard.writeText(this.snippet),this.copyIcon="check",(0,c.$)(this.cdr),setTimeout(()=>{this.copyIcon="copy",(0,c.$)(this.cdr)},1e3)}onPlaceholderChange(t){this.debouncePlaceholder.next(t)}onFiltersChange(){this.onFormChange()}showHints(){this.modalService.openModal(E)}preloadAlternativeWidget(){const t="old-widget-script";if(!document.querySelector(`#${t}`)){const i=window.document.createElement("script");i.id=t,i.type="text/javascript",i.async=!0,i.defer=!0,i.src=`${this.backendConfig.getCDN()}/nuclia-widget.umd.js`,window.document.body.appendChild(i)}}onFormChange(){this.generateSnippet(),this.sdk.currentKb.pipe((0,m.q)(1)).subscribe(t=>{this.widgetConfigurations[t.id]={features:this.features.split(","),placeholder:this.placeholder,filters:this.mainFormFeatures.filter?this.filters:void 0},this.localStorage.setItem(x,JSON.stringify(this.widgetConfigurations))})}updateTarget(t){const i=this.mainForm?.controls.features?.get("targetNewTab");i&&(t?i.enable():(i.patchValue(!1),i.disable()))}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(g.j3),e.Y36(S.H7),e.Y36(e.sBO),e.Y36(u.Fo),e.Y36(u.qE),e.Y36(c.sK),e.Y36(j.yp),e.Y36(u.rc),e.Y36($.f5),e.Y36(u.Qt))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-widget-generator"]],decls:12,vars:13,consts:[[1,"widget-generator"],["class","warning",4,"ngIf"],[1,"widget-preview"],["id","preview",1,"preview-container",3,"innerHtml"],[3,"formGroup",4,"ngIf"],[1,"warning"],["name","warning","size","large"],[1,"warning-content"],[1,"title-m",3,"innerHTML"],["class","publish-link body-m",4,"ngIf"],[1,"publish-link","body-m"],[3,"innerHTML"],[3,"routerLink"],[3,"formGroup"],[1,"snippet-configuration-container"],[1,"snippet-configuration"],[3,"value","valueChange"],["formControlName","prompt",3,"help","rows",4,"ngIf"],["formControlName","preselectedFilters",3,"rows","placeholder","help"],["formGroupName","features",1,"widget-features"],["labelOnRight","","help","stash.widgets.suggestions.help","formControlName","suggestions"],["labelOnRight","","help","stash.widgets.autocompleteFromNERs.help","formControlName","autocompleteFromNERs",4,"ngIf"],["labelOnRight","","help","stash.widgets.suggestLabels.help","formControlName","suggestLabels",4,"ngIf"],["labelOnRight","","help","stash.widgets.filter.help","formControlName","filter"],["class","filter-type",4,"ngIf"],["labelOnRight","","help","stash.widgets.answers.help","formControlName","answers"],["labelOnRight","","help","stash.widgets.onlyAnswers.help","formControlName","onlyAnswers"],["labelOnRight","","help","stash.widgets.hideSources.help","formControlName","hideSources"],["labelOnRight","","help","stash.widgets.relations.help","formControlName","relations"],["labelOnRight","","help","stash.widgets.knowledgeGraph.help","formControlName","knowledgeGraph",4,"ngIf"],["labelOnRight","","help","stash.widgets.navigateToLink.help","formControlName","navigateToLink",3,"valueChange"],["labelOnRight","","help","stash.widgets.targetNewTab.help","formControlName","targetNewTab"],["labelOnRight","","help","stash.widgets.navigateToFile.help","formControlName","navigateToFile"],["labelOnRight","","help","stash.widgets.permalink.help","formControlName","permalink"],["labelOnRight","","help","stash.widgets.synonyms.help","formControlName","useSynonyms",4,"ngIf"],["labelOnRight","","help","stash.widgets.autofilter.help","formControlName","autofilter"],["labelOnRight","","help","stash.widgets.displayMetadata.help","formControlName","displayMetadata"],["labelOnRight","","help","stash.widgets.hideThumbnails.help","formControlName","hideThumbnails"],["labelOnRight","","help","stash.widgets.noBM25forChat.help","formControlName","noBM25forChat"],["labelOnRight","","help","stash.widgets.hideLogo.help","formControlName","hideLogo",4,"ngIf"],["labelOnRight","","help","stash.widgets.darkMode.help","formControlName","darkMode"],[1,"snippet"],["aspect","basic","icon","info","iconAndText","",3,"click"],["aspect","basic","size","small",3,"icon","click",4,"ngIf"],[1,"highlight"],["formControlName","prompt",3,"help","rows"],["labelOnRight","","help","stash.widgets.autocompleteFromNERs.help","formControlName","autocompleteFromNERs"],["labelOnRight","","help","stash.widgets.suggestLabels.help","formControlName","suggestLabels"],[1,"filter-type"],[3,"value","disabled","valueChange"],[3,"value","disabled","valueChange",4,"ngIf"],["class","filter-warning",3,"innerHtml",4,"ngIf"],[1,"filter-warning",3,"innerHtml"],["labelOnRight","","help","stash.widgets.knowledgeGraph.help","formControlName","knowledgeGraph"],["labelOnRight","","help","stash.widgets.synonyms.help","formControlName","useSynonyms"],["labelOnRight","","help","stash.widgets.hideLogo.help","formControlName","hideLogo"],["aspect","basic","size","small",3,"icon","click"],["name","warning"],[1,"title-xxs"],[1,"body-m"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,D,7,6,"div",1),e.ALo(5,"async"),e.TgZ(6,"div",2)(7,"h3"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._UZ(10,"div",3),e.qZA(),e.YNc(11,re,86,93,"form",4),e.qZA()),2&i&&(e.xp6(2),e.hij(" ",e.lcZ(3,7,"stash.widgets.title")," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,9,n.showWarning)),e.xp6(2),e.ekj("dark",null==n.mainForm||null==n.mainForm.controls||null==n.mainForm.controls.darkMode?null:n.mainForm.controls.darkMode.value),e.xp6(2),e.Oqu(e.lcZ(9,11,"stash.widgets.preview")),e.xp6(2),e.Q6J("innerHtml",n.snippetPreview,e.oJD),e.xp6(1),e.Q6J("ngIf",n.mainForm))},dependencies:[w.O5,y.rH,g._Y,g.JJ,g.JL,g.sg,g.u,g.x0,q.a,H.R,L.r,Q.b,Y.n,F.o,w.Ov,C.X$],styles:['@charset "UTF-8";.widget-generator[_ngcontent-%COMP%]{padding:3rem 6rem}.widget-generator[_ngcontent-%COMP%] > .warning[_ngcontent-%COMP%]{margin-bottom:2rem}.widget-generator[_ngcontent-%COMP%]   .snippet[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{margin-bottom:1rem}.widget-generator[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{align-items:center;background:hsl(51,100%,55%);display:flex;gap:.5rem;padding:.5rem}.widget-generator[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]{flex-direction:column}.widget-generator[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%], .widget-generator[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   .publish-link[_ngcontent-%COMP%]{display:flex;gap:.25rem}.widget-generator[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:inherit;text-decoration:underline}.widget-generator[_ngcontent-%COMP%]   .filter-warning[_ngcontent-%COMP%]{color:#707070;padding:.25rem 0 0 1.75rem}.widget-generator[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;min-height:4.5rem}.widget-generator[_ngcontent-%COMP%]   .snippet-configuration-container[_ngcontent-%COMP%]{display:flex;gap:1.5rem;margin-top:1.5rem}.widget-generator[_ngcontent-%COMP%]   .snippet-configuration-container[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{background:hsl(240,7%,97%);border-radius:.25rem;padding:1rem 1.5rem}.widget-generator[_ngcontent-%COMP%]   .snippet-configuration-container[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:300}.widget-generator[_ngcontent-%COMP%]   .snippet-configuration-container[_ngcontent-%COMP%]   section.snippet-configuration[_ngcontent-%COMP%]{display:flex;flex:0 0 auto;flex-direction:column;gap:1rem;width:28rem}.widget-generator[_ngcontent-%COMP%]   .snippet-configuration-container[_ngcontent-%COMP%]   section.snippet-configuration[_ngcontent-%COMP%]   .widget-features[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.widget-generator[_ngcontent-%COMP%]   .snippet-configuration-container[_ngcontent-%COMP%]   section.snippet-configuration[_ngcontent-%COMP%]   .filter-type[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-left:4rem}.widget-generator[_ngcontent-%COMP%]   .snippet-configuration-container[_ngcontent-%COMP%]   section.snippet[_ngcontent-%COMP%]{flex:1 0 auto;max-width:calc(100vw - 44.5rem)}.widget-generator[_ngcontent-%COMP%]   .snippet-configuration-container[_ngcontent-%COMP%]   section.snippet[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:space-between}.widget-generator[_ngcontent-%COMP%]   .snippet-configuration-container[_ngcontent-%COMP%]   section.snippet[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0;word-break:break-all}.widget-generator[_ngcontent-%COMP%]   .widget-preview.dark[_ngcontent-%COMP%]{background:#1f2023;color:#fff;padding:1rem}'],changeDetection:0})}return a})()}];let ge=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275mod=e.oAB({type:a});static#n=this.\u0275inj=e.cJS({imports:[w.ez,C.aw.forChild(),y.Bz.forChild(ce),g.UX,c.p,c.w1,c.nc,k._J,c.v6,c.$Q]})}return a})()}}]);