{"version":3,"file":"lib_index_js.13ec67500ec74507d130.js","mappings":"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","sources":["webpack://jupyterlab-nbhosting/./src/index.tsx"],"sourcesContent":["// still missing from the notebook classic version\n// * enable_move_up_down\n//   -> dropping this, no need as we can use the mouse to drag cells\n// * show_metadata_in_header -> should go in courselevels\n//   -> dropping this\n// * inactivate_non_code_cells\n//   -> xxx might be worth revisiting\n// * redefine_enter_in_command_mode\n//   -> xxx might be worth revisiting\n//\n/// dropping copy-to-clipboard\n// https://github.com/parmentelat/jupyterlab-nbhosting/issues/1\n// I am dismantling former copy-to-clipboard feature\n\nimport { JupyterFrontEnd, JupyterFrontEndPlugin } from '@jupyterlab/application'\n\nimport { ICommandPalette, showDialog } from '@jupyterlab/apputils'\n\nimport { ISettingRegistry } from '@jupyterlab/settingregistry'\n\nimport { CommandRegistry } from '@lumino/commands'\n\nimport React from 'react'\n\n//\n//  Initialization data for the jupyterlab-nbhosting extension.\n//\nconst plugin: JupyterFrontEndPlugin<void> = {\n  id: 'jupyterlab-nbhosting:plugin',\n  description: 'Custom look and feel for nbhosting notebooks',\n  autoStart: true,\n  requires: [ICommandPalette],\n  optional: [ISettingRegistry],\n  activate: (\n    app: JupyterFrontEnd,\n    palette: ICommandPalette,\n    settingRegistry: ISettingRegistry | null,\n  ) => {\n    if (settingRegistry) {\n      settingRegistry\n        .load(plugin.id)\n        .then(settings => {\n          console.log(\n            'jupyterlab-nbhosting settings loaded:',\n            settings.composite,\n          )\n        })\n        .catch(reason => {\n          console.error(\n            'Failed to load settings for jupyterlab-nbhosting.',\n            reason,\n          )\n        })\n    }\n\n    ////// helpers\n    const get_url_param = (name: string) => {\n      // get a URL parameter. I cannot believe we actually need this.\n      // Based on http://stackoverflow.com/a/25359264/938949\n      const match = new RegExp('[?&]' + name + '=([^&]*)').exec(\n        window.location.search,\n      )\n      if (match) {\n        return decodeURIComponent(match[1] || '')\n      }\n    }\n\n    const course = get_url_param('course')\n    const student = get_url_param('student')\n    // window.location.pathname looks like this\n    // \"/35162/notebooks/w1/w1-s3-c4-fibonacci-prompt.ipynb\"\n    const regexp = new RegExp('^/([0-9]+)/notebooks/(.*)')\n    // groups 1 and 2 refer to port and notebook respectively\n    const map = { port: 1, notebook: 2 }\n    const match = regexp.exec(window.location.pathname)\n    const notebook = match ? match[map.notebook] : undefined\n\n    const not_under_nbhosting = () => {\n      showDialog({\n        title: 'Available under nbhosting only',\n        body: \"You don't appear to be running inside nbhosting, sorry\",\n        buttons: [\n          {\n            label: 'Ok',\n            caption: 'Ok',\n            iconLabel: 'Ok',\n            accept: true,\n            className: 'nbh-dialog-button',\n            ariaLabel: 'aria-label',\n            iconClass: 'icon-class',\n            actions: [],\n            displayType: 'default',\n          },\n        ],\n        defaultButton: 0,\n      })\n    }\n\n    const reset_to_original = (arg: any) => {\n      if (!notebook) {\n        not_under_nbhosting()\n        return\n      }\n      showDialog({\n        title: 'Confirm reset to original',\n        body: (\n          <span>\n            are you sure to reset your notebook to the original version ?\n            <br />\n            all your changes will be lost...\n          </span>\n        ),\n        buttons: [\n          // why on earth are all those settings here for ?\n          {\n            label: 'Reset',\n            caption: 'Reset',\n            iconLabel: 'Reset',\n            accept: true,\n            className: 'nbh-dialog-button',\n            ariaLabel: 'aria-label',\n            iconClass: 'icon-class',\n            actions: [],\n            displayType: 'default',\n          },\n          {\n            label: 'Cancel',\n            caption: 'Cancel',\n            iconLabel: 'Cancel',\n            accept: false,\n            className: 'nbh-dialog-button',\n            ariaLabel: 'aria-label',\n            iconClass: 'icon-class',\n            actions: [],\n            displayType: 'default',\n          },\n        ],\n        defaultButton: 0,\n      }).then(answer => {\n        if (answer.button.accept) {\n          if (!notebook) {\n            console.log('not under nbhosting')\n            return\n          }\n          const reset_url = `/notebookLazyCopy/${course}/${notebook}/${student}?forcecopy=true`\n          console.log('resetting -> ', reset_url)\n          window.location.href = reset_url\n        }\n      })\n    }\n\n    const share_static_version = async (arg: any) => {\n      if (!notebook) {\n        not_under_nbhosting()\n        return\n      }\n      const share_url = `/ipythonShare/${course}/${notebook}/${student}`\n      try {\n        const response = await fetch(share_url)\n        const jsonData = await response.json()\n        let message: string | JSX.Element\n        if ('error' in jsonData) {\n          message = `Could not create snapshot\\n${jsonData.error}`\n        } else {\n          message = (\n            <div className=\"nbh-dialog\">\n              <p className=\"nbh-larger\">\n                To share a static version of your notebook, copy this link:\n                <a id=\"try-share-url\" target=\"_blank\" href={jsonData.url_path}>\n                  Try the link\n                </a>\n              </p>\n              <span id=\"share-url\">{jsonData.url_path}</span>\n              <p className=\"nbh-larger\">\n                Note that sharing the same notebook several times overwrites the\n                same snapshot\n              </p>\n            </div>\n          )\n        }\n        //\n        showDialog({\n          title: 'Static version created (or overwritten)',\n          body: message,\n          buttons: [\n            // why on earth are all those settings here for ?\n            {\n              label: 'Ok',\n              caption: 'Ok',\n              iconLabel: 'Ok',\n              accept: false,\n              className: 'nbh-dialog-button',\n              ariaLabel: 'aria-label',\n              iconClass: 'icon-class',\n              actions: [],\n              displayType: 'default',\n            },\n          ],\n          defaultButton: 0,\n        }).then(answer => {\n          console.log(`URL for shared static version is ${jsonData.url_path}`)\n        })\n      } catch (error) {\n        console.log(`Error when using URL ${share_url}`)\n        return\n      }\n    }\n\n    const show_student_id = (arg: any) => {\n      if (!notebook) {\n        not_under_nbhosting()\n        return\n      }\n      showDialog({\n        title: 'Your student id',\n        body: (\n          <div className=\"nbh-dialog\">\n            <p className=\"nbh-larger\">please copy and paste your id</p>\n            <div id=\"student-id\">{student}</div>\n            <p>when you report an issue with the platform</p>\n          </div>\n        ),\n        buttons: [\n          {\n            label: 'Ok',\n            caption: 'Ok',\n            iconLabel: 'Ok',\n            accept: false,\n            className: 'nbh-dialog-button',\n            ariaLabel: 'aria-label',\n            iconClass: 'icon-class',\n            actions: [],\n            displayType: 'default',\n          },\n        ],\n        defaultButton: 0,\n      }).then(answer => {\n        if (student === undefined) {\n          console.log('undefined student')\n          return\n        }\n        console.log(`student id is ${student}`)\n      })\n    }\n    //////// create commands\n\n    const { commands } = app\n\n    let command: string\n    const category = 'nbhosting'\n\n    command = 'nbhosting:reset-to-original'\n    commands.addCommand(command, {\n      label: 'Reset to Original',\n      // caption: 'captions of reset-to-original',\n      execute: reset_to_original,\n    })\n    palette.addItem({ command, category })\n\n    command = 'nbhosting:share-static-version'\n    commands.addCommand(command, {\n      label: 'Share Static Version',\n      // caption: 'captions of share-static-version',\n      execute: share_static_version,\n    })\n    palette.addItem({ command, category })\n\n    command = 'nbhosting:show-student-id'\n    commands.addCommand(command, {\n      label: 'Show Student id',\n      // caption: 'captions of show-student-id',\n      execute: show_student_id,\n    })\n    palette.addItem({ command, category })\n\n    // to invoke a command\n    // we may need to wait for the command to be registered\n    // under notebook this function is called toggle-top\n    const command_to_run = 'application:toggle-top'\n    if (app.commands.hasCommand(command_to_run)) {\n      app.commands.execute(command_to_run)\n    } else {\n      console.log(`waiting for the ${command_to_run} command to register`, app)\n      const callback = (\n        commands: CommandRegistry,\n        changes: CommandRegistry.ICommandChangedArgs,\n      ) => {\n        if (changes.type === 'added' && changes.id === command_to_run) {\n          app.commands.execute(command_to_run)\n          commands.commandChanged.disconnect(callback)\n        }\n      }\n      app.commands.commandChanged.connect(callback)\n    }\n\n    // shorter autosave interval\n    if (settingRegistry) {\n      console.log(\n        'jupyterlab-nbhosting is setting autosaveInterval to 5 seconds',\n      )\n      settingRegistry\n        .load('@jupyterlab/docmanager-extension:plugin')\n        .then((nbSettings: ISettingRegistry.ISettings) =>\n          nbSettings.set('autosaveInterval', 5),\n        )\n        .catch((err: Error) => {\n          console.error(\n            `jupyterlab-nbhosting: Could not set autosaveInterval : ${err}`,\n          )\n        })\n    }\n\n    console.log('JupyterLab extension jupyterlab-nbhosting has activated!')\n  },\n}\n\nexport default plugin\n"],"names":[],"sourceRoot":""}